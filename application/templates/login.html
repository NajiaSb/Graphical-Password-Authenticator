{% extends "layout.html" %} 
{% block content %}
<div class="text-center form-signin w-100 m-auto">
  <form action="{{ url_for('login') }}" method="post">
    <h2 class="h2 fw-normal">Login</h2>
    <div class="form-floating" style="margin: 3% 0%">
      <input
        type="text"
        class="form-control"
        placeholder="Username"
        style="height: 40px"
        name="username"
        required
      />
      <label>Username</label>
    </div>
    <div class="form-floating" style="padding: 5%; display: inline">
      <p class="p">Select 8 images as your graphical password:</p>
      <div class="grid">
        {% for data in imageData %} 
          <img src="{{ data['image'] }}"
            alt="{{ data['alt'] }}"
            onclick="selectImage(this)"
            style="cursor: pointer;"
          >
        {% endfor %}
      </div>
      <input type="hidden" id="selected_images" name="selected_images" />
    </div>

    <button class="w-100 btn btn-lg btn-primary" type="submit">Login</button>
  </form>
</div>

<script type="text/javascript">
  // Keep track of selected images
  var selectedImages = [];

  // Add click event listener to images
  var images = document.querySelectorAll(".grid img");
  images.forEach(function (image) {
    image.addEventListener("click", function () {
      if (selectedImages.length < 8 && !selectedImages.includes(image.alt)) {
        selectedImages.push(image.alt);
        image.style.border = "1px solid gray";
      } else if (selectedImages.includes(image.alt)) {
        var index = selectedImages.indexOf(image.alt);
        if (index !== -1) {
          selectedImages.splice(index, 1);
          image.style.border = "none";
        }
      }
      document.getElementById("selected_images").value =
        selectedImages.join(",");
      console.log(selectedImages);
    });
  });
</script>
{% endblock %}
